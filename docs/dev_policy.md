# Axiom Shift プロジェクト開発基本方針

## 1. アーキテクチャ

- **レイヤードアーキテクチャ**を採用し、依存方向は内向きのみ。
  - `cmd → app → usecase → domain` のみ許可。
  - `infra`は外側に位置し、interface アダプタとして`usecase`に依存可。
- ディレクトリ構成は以下の通り：

```
axiom_shift/
├── cmd/axiomshift/         # エントリポイント(main.go)
├── internal/
│   ├── app/                # Ebitenゲームループ
│   ├── domain/             # エンティティ・値オブジェクト
│   ├── usecase/            # 戦闘進行・ゲームセッション
│   ├── infra/ebitenui/     # Ebiten描画・入力アダプタ
│   ├── game/               # ゲームロジック
│   ├── logic/              # ルール・乱数
│   └── ui/                 # UIロジック
├── pkg/                    # 汎用ユーティリティ
├── assets/                 # フォント・画像等
├── docs/                   # ドキュメント
└── README.md
```

## 2. テスト方針

- **main.go 以外の全パッケージでユニットテスト必須**。
- 正常系だけでなく、**異常系・ガード節も必ずテスト**し、カバレッジ 100%を目指す。
- Ebiten の`Draw`や`Update`等の副作用メソッドは自動テスト困難なため、カバレッジ 0%でも許容。
- テストは`go test ./...`で一括実行し、`go tool cover -func=coverage.out`で関数単位のカバレッジを確認。

## 3. コーディング規約

- main.go には DI と Ebiten 起動のみを書く。
- ロジック層はテスト容易性・再現性を重視し、乱数シードは切り替え可能に。
- UI 描画は MVP 段階では`ebitenutil.DebugPrint`等のテキスト描画で OK。
- 依存パッケージは`go.mod`で管理し、Ebiten は最新安定版を利用。
- CI を想定し、`go vet`や`staticcheck`が通る品質を保つ。

## 4. カバレッジ運用

- カバレッジレポートで 100%未満の場合は、未カバー分岐（エラー系・ガード節）を追加テスト。
- 0%は UI やフレームワーク依存部分のみ許容。
- 主要ロジック関数は全て 100%カバーされていることを保証。

## 5. ドキュメント管理

- 本方針や設計・仕様は`docs/`配下に Markdown で管理。
- 仕様変更や設計方針の更新は必ずドキュメントに反映すること。

---

この方針に従い、Axiom Shift の開発・運用・保守を行うこと。
